this code is in write mode